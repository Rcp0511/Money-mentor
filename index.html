<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Unit 1 Quiz</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css"/>
<style>
body { margin:0; font-family:'Montserrat', sans-serif; background:#e0f5e0; color:#111; }
header { background:#388e3c; color:#fff; padding:25px; text-align:center; font-size:2em; font-weight:700; box-shadow:0 4px 10px rgba(0,0,0,0.3); }
.container { max-width:900px; margin:30px auto; padding:0 10px; }
.unit-card { background:#4caf50; border-radius:20px; margin-bottom:25px; padding:25px; box-shadow:0 6px 18px rgba(0,0,0,0.2); cursor:pointer; transition:0.2s; }
.unit-card:hover { transform:scale(1.02); }
.unit-header { display:flex; justify-content:space-between; align-items:center; }
.unit-header .title { display:flex; align-items:center; gap:10px; font-weight:600; font-size:1.3em; }
.unit-header .scores { font-size:0.95em; color:#0a3d0a; }
.unit-header .unit-complete { font-size:1.3em; color:gold; font-weight:bold; }
.unit-dropdown { display:none; flex-direction:column; gap:12px; margin-top:15px; }
.unit-dropdown button { padding:14px 0; border:none; border-radius:15px; font-size:1.1em; font-weight:500; color:white; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:10px; }
.study-btn { background:#2e7d32; }
.test-btn { background:#1b5e20; }

#quizOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.6); justify-content:center; align-items:center; z-index:1000; overflow:auto; }
.quiz-container { background:#fff; border-radius:25px; padding:30px; width:80%; max-width:850px; min-height:600px; max-height:90%; overflow-y:auto; position:relative; }

#closeQuiz { position:absolute; top:15px; right:20px; font-size:2em; cursor:pointer; z-index:10; }
#flagBtn { position:absolute; top:15px; right:60px; font-size:1.5em; background:none; border:none; cursor:pointer; color:red; z-index:10; display:none; }

#startScreen { text-align:center; background:#4caf50; padding:60px 20px; border-radius:0; margin:0; width:100%; box-sizing:border-box; min-height:300px; }
#startBtn { padding:18px 28px; font-size:1.3em; border:none; border-radius:15px; background:#28a745; color:white; cursor:pointer; margin-top:25px; }
#startBtn:hover { background:#218838; }

#quiz { display:none; }
.question-number { font-size:1em; color:#666; margin-bottom:5px; }
.question { font-size:1.4em; margin-bottom:25px; }
.options button { display:block; width:100%; margin:10px 0; padding:14px; font-size:1.1em; border:2px solid #ccc; border-radius:12px; cursor:pointer; text-align:left; background:#fdfdfd; transition:0.2s; }
.options button:hover { border-color:#007bff; background-color:#e0f0ff; }
.options button.selected { background-color:#d4edda; border-color:#28a745; }

.controls { display:flex; justify-content:space-between; margin-top:20px; }
.controls button { padding:12px 18px; border:none; border-radius:10px; cursor:pointer; font-size:1em; }
#nextBtn { background:#007bff; color:white; }
#nextBtn:hover { background:#0056b3; }
#prevBtn { background:#6c757d; color:white; }
#prevBtn:hover { background:#5a6268; }

.progress-bar { height:14px; background:#eee; border-radius:7px; overflow:hidden; margin-top:25px; }
.progress { height:100%; width:0%; background:linear-gradient(90deg,#28a745,#85e085); transition:width 0.3s; }

#review { display:none; margin-top:15px; }
#review h2 { text-align:center; margin-bottom:15px; }
.review-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(70px,1fr)); gap:12px; margin-top:10px; }
.review-box { padding:14px; text-align:center; border-radius:10px; cursor:pointer; position:relative; font-weight:600; }

.review-box.answered { background-color:green; color:white; }
.review-box.unanswered { background-color:gray; color:white; }
.review-box.flagged i { position:absolute; top:5px; right:5px; color:red; }

#scoreScreen { display:none; text-align:left; margin-top:20px; overflow-y:auto; max-height:500px; }
#scoreScreen li { margin:10px 0; padding:10px; border-radius:6px; display:flex; align-items:flex-start; gap:10px; }
.correct-score { color:green; }
.wrong-score { color:red; }

.restart-btn { margin-top:25px; padding:14px 22px; border:none; border-radius:12px; background:#28a745; color:white; cursor:pointer; font-size:1.1em; }
.restart-btn:hover { background:#218838; }
</style>
</head>
<body>
<header>Student Dashboard</header>
<div class="container" id="unitContainer"></div>

<div id="quizOverlay">
  <div class="quiz-container">
    <span id="closeQuiz">&times;</span>
    <button id="flagBtn"><i class="far fa-flag"></i></button>

    <div id="startScreen">
      <h2>üìà Unit 1: Investing Vocab üìà</h2>
      <button class="restart-btn" id="startBtn">Start Quiz</button>
    </div>

    <div id="quiz">
      <div class="question-number" id="questionNumber"></div>
      <div class="question" id="question"></div>
      <div class="options" id="options"></div>
      <div class="controls">
        <button id="prevBtn">Previous</button>
        <button id="nextBtn">Next</button>
      </div>
      <div class="progress-bar"><div class="progress" id="progress"></div></div>
    </div>

    <div id="review">
      <h2>Review Page</h2>
      <div id="reviewLegend" style="margin-bottom:10px;">
        <span style="color:green;font-weight:bold;">Answered</span> | 
        <span style="color:gray;font-weight:bold;">Not Answered</span> | 
        <i class="fas fa-flag" style="color:red;"></i> Flagged
      </div>
      <div class="review-grid" id="reviewGrid"></div>
      <button class="restart-btn" id="toScoreBtn">Submit Quiz</button>
    </div>

    <div id="scoreScreen">
      <h3>Your Score</h3>
      <ul id="missedList"></ul>
      <p id="lastScoreText"></p>
      <p id="highScoreText"></p>
      <button class="restart-btn" id="restartBtn">Restart Quiz</button>
    </div>
  </div>
</div>

<script>
// ------------------ Units ------------------
const units=[{name:"Unit 1: Investing Vocab", mastered:false,lastScore:null,highScore:null}];
const container=document.getElementById('unitContainer');

let savedScores=JSON.parse(localStorage.getItem('unitScores')) || {};
if(savedScores['Unit 1']) {
  units[0].lastScore=savedScores['Unit 1'].lastScore;
  units[0].highScore=savedScores['Unit 1'].highScore;
  units[0].mastered=savedScores['Unit 1'].mastered;
}

function updateCardScore(div, unit){
  div.textContent=`Last: ${unit.lastScore||'N/A'} | High: ${unit.highScore||'N/A'}`;
}

units.forEach((unit)=>{
  const card=document.createElement('div'); card.className='unit-card';
  const header=document.createElement('div'); header.className='unit-header';
  const titleDiv=document.createElement('div'); titleDiv.className='title'; titleDiv.textContent=unit.name;
  const scoreDiv=document.createElement('div'); scoreDiv.className='scores'; updateCardScore(scoreDiv, unit);
  header.appendChild(titleDiv); header.appendChild(scoreDiv);
  card.appendChild(header);

  if(unit.mastered){
    const star=document.createElement('span'); star.className='unit-complete'; star.innerHTML='‚≠ê'; header.appendChild(star);
  }

  const dropdown=document.createElement('div'); dropdown.className='unit-dropdown';
  const studyBtn=document.createElement('button'); studyBtn.className='study-btn'; studyBtn.innerHTML='<i class="fas fa-book"></i> Study'; studyBtn.onclick=()=>alert(`Study ${unit.name}`);
  const testBtn=document.createElement('button'); testBtn.className='test-btn'; testBtn.innerHTML='<i class="fas fa-clipboard"></i> Unit Test'; testBtn.onclick=openQuiz;
  dropdown.appendChild(studyBtn); dropdown.appendChild(testBtn); card.appendChild(dropdown);

  card.onclick=()=>{ dropdown.style.display=dropdown.style.display==='flex'?'none':'flex'; };
  container.appendChild(card);
});

// ------------------ Quiz Logic ------------------
// [Quiz data, question load, flags, answers, review, score calculation as before]

// -- Rest of quiz code same as previous version, with flag only visible per question in review
// -- Scrollbars work, overlay larger, start page fills entire green area
</script>
</body>
</html>
