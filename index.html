<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Student Dashboard</title>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
<style>
body { margin:0; font-family:'Montserrat', sans-serif; background:#f5f5f5; color:#111; }
header { background:#388e3c; color:#fff; padding:20px; text-align:center; font-size:2em; font-weight:700; }
.container { max-width:900px; margin:20px auto; padding:0 15px; }
.unit-card { background:#4caf50; border-radius:18px; margin-bottom:20px; padding:20px; box-shadow:0 5px 15px rgba(0,0,0,0.1); transition: transform 0.3s ease; cursor:pointer; color:white;}
.unit-card:hover { transform: translateY(-2px); }
.unit-header { display:flex; justify-content:space-between; align-items:center; cursor:pointer; }
.unit-header .title { display:flex; align-items:center; gap:10px; font-weight:600; font-size:1.2em; }
.unit-header .title .star { color:gold; font-size:1.2em; }
.unit-header .scores { font-size:0.9em; }
.unit-dropdown { display:none; margin-top:15px; gap:10px; }
.unit-dropdown button { flex:1; padding:12px 0; border:none; border-radius:12px; font-size:1em; font-weight:500; color:white; cursor:pointer; display:flex; align-items:center; justify-content:center; gap:8px; transition: all 0.2s ease; background:#2e7d32; }
.unit-dropdown button.test-btn { background:#1b5e20; }
.unit-dropdown button:hover { transform: scale(1.05); }
@media(max-width:600px){ .unit-header { flex-direction: column; align-items:flex-start; gap:5px; } .unit-dropdown { flex-direction: column; } }

/* Quiz Overlay */
#quizOverlay { display:none; position:fixed; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.7); z-index:1000; overflow:auto; }
.quiz-container { background:#fff; max-width:500px; margin:50px auto; padding:25px; border-radius:20px; position:relative; }
#topRestart,#closeOverlay { position:absolute; top:15px; padding:8px 12px; border:none; border-radius:8px; cursor:pointer; color:white; }
#topRestart { left:15px; background:#dc3545; display:none; } 
#closeOverlay { right:15px; background:#888; }
#startScreen,#quiz,.review,#scoreScreen { display:none; text-align:center; }
.start-btn { padding:15px 25px; font-size:1.2em; border:none; border-radius:12px; background:#28a745; color:white; cursor:pointer; }
.start-btn:hover { background:#218838; }
.question-number { font-size:0.9em; color:#666; margin-bottom:5px; }
.question { font-size:1.2em; margin-bottom:15px; }
.options button { display:block; width:100%; margin:8px 0; padding:12px; font-size:1em; border:2px solid #ccc; border-radius:10px; cursor:pointer; text-align:left; background:#fdfdfd; }
.options button:hover { border-color:#007bff; background:#e0f0ff; }
.options button.selected { background:#d4edda; border-color:#28a745; }
.controls { display:flex; justify-content:space-between; margin-top:15px; }
.controls button { padding:8px 12px; border:none; border-radius:8px; cursor:pointer; color:white; }
#prevBtn { background:#6c757d; } #nextBtn { background:#007bff; } #flagBtn { background:#ffc107; color:black; }
.progress-bar { height:12px; background:#eee; border-radius:6px; margin-top:15px; }
.progress { height:100%; width:0%; background:linear-gradient(90deg,#28a745,#85e085); transition:0.3s; }
.review-grid { display:grid; grid-template-columns:repeat(auto-fit,minmax(40px,1fr)); gap:8px; margin:10px 0; }
.review-box { padding:8px; border-radius:6px; font-size:0.85em; cursor:pointer; position:relative; }
.review-box.answered { background:#ccc; } .review-box.notanswered { background:#e57373; color:white; }
.review-box.flagged::after { content:"⚑"; color:red; position:absolute; top:2px; right:2px; font-size:0.9em; }
.restart-btn { margin-top:15px; padding:10px 18px; border:none; border-radius:10px; background:#28a745; color:white; cursor:pointer; }
.restart-btn:hover { background:#218838; }
</style>
</head>
<body>

<header>Student Dashboard</header>
<div class="container" id="unitContainer"></div>

<div id="quizOverlay">
  <div class="quiz-container">
    <button id="topRestart">Restart Quiz</button>
    <button id="closeOverlay">✖</button>

    <div id="startScreen">
      <h2 id="unitTitle">Unit Test Quiz</h2>
      <button class="start-btn" id="startBtn">Start Quiz</button>
      <p id="scoreInfo"></p>
    </div>

    <div id="quiz">
      <div class="question-number" id="questionNumber"></div>
      <div class="question" id="question"></div>
      <div class="options" id="options"></div>
      <div class="controls">
        <button id="prevBtn">Previous</button>
        <button id="flagBtn">Flag</button>
        <button id="nextBtn">Next</button>
      </div>
      <div class="progress-bar"><div class="progress" id="progress"></div></div>
    </div>

    <div class="review">
      <h3>Review Questions</h3>
      <div class="review-grid" id="reviewGrid"></div>
      <button id="submitBtn" class="restart-btn">Submit Quiz</button>
    </div>

    <div id="scoreScreen">
      <h3 id="scoreText"></h3>
      <ul id="missedList"></ul>
      <p id="lastScoreText"></p>
      <p id="highScoreText"></p>
      <button id="restartBtn" class="restart-btn">Restart Quiz</button>
    </div>

  </div>
</div>

<script>
// ======= Units =======
const units = [
  {name:"Unit 1: Investing Vocab", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 2: Stocks & Bonds", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 3: Financial Statements", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 4: Economics Basics", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 5: Market Trends", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 6: Risk Management", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 7: Portfolio Strategy", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 8: Retirement Planning", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 9: Taxes", lastScore:null, highScore:null, mastered:false},
  {name:"Unit 10: Review & Test Prep", lastScore:null, highScore:null, mastered:false}
];

const container=document.getElementById('unitContainer');
units.forEach((unit,i)=>{
  const card=document.createElement('div'); card.className='unit-card';
  const header=document.createElement('div'); header.className='unit-header';
  const titleDiv=document.createElement('div'); titleDiv.className='title'; 
  if(unit.mastered) titleDiv.innerHTML='★ '+unit.name; else titleDiv.textContent=unit.name;
  const scoreDiv=document.createElement('div'); scoreDiv.className='scores';
  scoreDiv.textContent=`Last Unit Test Score: ${unit.lastScore!==null?unit.lastScore:'N/A'} | Highest Unit Test Score: ${unit.highScore!==null?unit.highScore:'N/A'}`;
  header.appendChild(titleDiv); header.appendChild(scoreDiv);
  card.appendChild(header);

  const dropdown=document.createElement('div'); dropdown.className='unit-dropdown';
  const studyBtn=document.createElement('button'); studyBtn.className='study-btn';
  studyBtn.innerHTML='<i class="fa-solid fa-book"></i> Study'; studyBtn.onclick=()=>alert('Study '+unit.name);
  const testBtn=document.createElement('button'); testBtn.className='test-btn';
  testBtn.innerHTML='<i class="fa-solid fa-file"></i> Unit Test'; 
  testBtn.onclick=()=>openQuiz(i); 
  dropdown.appendChild(studyBtn); dropdown.appendChild(testBtn); card.appendChild(dropdown);
  header.onclick=()=>{ dropdown.style.display = dropdown.style.display==='flex'?'none':'flex'; };
  container.appendChild(card);
});

// ======= Quiz Data =======
const quizDataUnit1=[
  {q:"What is a 'stock'?",a:["Ownership share","Type of loan","Company expense","Bank account"],correct:0},
  {q:"What is a 'bond'?",a:["Loan to company/government","Stock","Debt you own","Savings account"],correct:0},
  {q:"What is an 'asset'?",a:["Something valuable you own","Debt you owe","Company liability","Stock market"],correct:0},
  {q:"What does ROI stand for?",a:["Return on Investment","Rate of Interest","Revenue over Income","Ratio of Income"],correct:0},
  {q:"Diversification means?",a:["Spreading investments","Investing all in one","Selling stocks","Buying bonds only"],correct:0},
  {q:"Liquidity is?",a:["Ease of converting to cash","Long-term investment","Stock growth","Interest rate"],correct:0},
  {q:"Dividend is?",a:["Profit share to stockholders","Company expense","Tax payment","Loan interest"],correct:0},
  {q:"Bull market means?",a:["Prices rising","Prices falling","Stable prices","Market crash"],correct:0},
  {q:"Bear market means?",a:["Prices falling","Prices rising","Stable prices","No trading"],correct:0},
  {q:"Capital gain is?",a:["Profit from sale of asset","Company loss","Interest earned","Dividend paid"],correct:0}
];

// ======= Variables =======
const quizOverlay=document.getElementById('quizOverlay');
const startScreen=document.getElementById('startScreen');
const startBtn=document.getElementById('startBtn');
const scoreInfo=document.getElementById('scoreInfo');
const quizDiv=document.getElementById('quiz');
const questionNumberEl=document.getElementById('questionNumber');
const questionEl=document.getElementById('question');
const optionsEl=document.getElementById('options');
const prevBtn=document.getElementById('prevBtn');
const nextBtn=document.getElementById('nextBtn');
const flagBtn=document.getElementById('flagBtn');
const progressEl=document.getElementById('progress');
const reviewDiv=document.querySelector('.review');
const reviewGrid=document.getElementById('reviewGrid');
const submitBtn=document.getElementById('submitBtn');
const scoreScreen=document.getElementById('scoreScreen');
const scoreText=document.getElementById('scoreText');
const missedList=document.getElementById('missedList');
const restartBtn=document.getElementById('restartBtn');
const lastScoreText=document.getElementById('lastScoreText');
const highScoreText=document.getElementById('highScoreText');
const topRestart=document.getElementById('topRestart');
const closeOverlay=document.getElementById('closeOverlay');
const unitTitle=document.getElementById('unitTitle');

let currentUnitIndex=0,current=0,questionOrder=[],answers=[],flags=[],shuffledChoices=[];

// ======= Functions =======
function shuffleArray(arr){for(let i=arr.length-1;i>0;i--){let j=Math.floor(Math.random()*(i+1));[arr[i],arr[j]]=[arr[j],arr[i]];}}

function openQuiz(index){
  currentUnitIndex=index;
  quizOverlay.style.display='block';
  startScreen.style.display='block';
  quizDiv.style.display='none';
  reviewDiv.style.display='none';
  scoreScreen.style.display='none';
  topRestart.style.display='none';
  unitTitle.textContent=units[index].name;
  scoreInfo.textContent=`Last Unit Test Score: ${units[index].lastScore!==null?units[index].lastScore:'N/A'} | Highest Unit Test Score: ${units[index].highScore!==null?units[index].highScore:'N/A'}`;
}

// ======= Start Quiz =======
startBtn.onclick=()=>{
  startScreen.style.display='none';
  quizDiv.style.display='block';
  topRestart.style.display='block';

  questionOrder=Array.from(Array(quizDataUnit1.length).keys());
  shuffleArray(questionOrder);
  shuffledChoices=quizDataUnit1.map(q=>{let arr=q.a.map((t,i)=>({text:t,index:i})); shuffleArray(arr); return arr; });
  current=0; answers=Array(quizDataUnit1.length).fill(null); flags=Array(quizDataUnit1.length).fill(false);
  loadQuestion();
};

// Load Question
function loadQuestion(){
  const qIndex=questionOrder[current]; const q=quizDataUnit1[qIndex];
  questionNumberEl.textContent=`Question ${current+1} of ${quizDataUnit1.length}`;
  questionEl.textContent=q.q;
  optionsEl.innerHTML='';
  shuffledChoices[qIndex].forEach(c=>{
    const btn=document.createElement('button'); btn.textContent=c.text;
    if(answers[qIndex]===c.index) btn.classList.add('selected');
    btn.onclick=()=>{ answers[qIndex]=c.index; loadQuestion(); };
    optionsEl.appendChild(btn);
  });
  flagBtn.textContent= flags[qIndex] ? "Flagged" : "Flag";
  progressEl.style.width=`${((current+1)/quizDataUnit1.length)*100}%`;
}

// Controls
nextBtn.onclick=()=>{ if(current<quizDataUnit1.length-1){current++;loadQuestion();} else showReview();}
prevBtn.onclick=()=>{ if(current>0){current--;loadQuestion();}}
flagBtn.onclick=()=>{ flags[questionOrder[current]] = !flags[questionOrder[current]]; loadQuestion();}
topRestart.onclick=()=>{ if(confirm("Restart quiz?")) startBtn.click();}
restartBtn.onclick=()=>{ if(confirm("Restart quiz?")) startBtn.click();}
closeOverlay.onclick=()=>{ quizOverlay.style.display='none'; }

// Review
function showReview(){
  quizDiv.style.display='none';
  reviewDiv.style.display='block';
  reviewGrid.innerHTML='';
  quizDataUnit1.forEach((q,i)=>{
    const box=document.createElement('div'); box.className='review-box';
    if(answers[i]===null) box.classList.add('notanswered'); else box.classList.add('answered');
    if(flags[i]) box.classList.add('flagged');
    box.textContent=`Q${i+1}`; 
    box.onclick=()=>{ reviewDiv.style.display='none'; quizDiv.style.display='block'; current=i; loadQuestion(); };
    reviewGrid.appendChild(box);
  });
}

// Submit
submitBtn.onclick=()=>{
  let score=0; let missed=[];
  quizDataUnit1.forEach((q,i)=>{ if(answers[i]===q.correct) score++; else missed.push(`${i+1}: ${q.q}`); });
  let pct=Math.round(score/quizDataUnit1.length*100);
  scoreText.textContent=`Score: ${pct}% (${score}/${quizDataUnit1.length})`;
  missedList.innerHTML=''; missed.forEach(m=>{let li=document.createElement('li'); li.textContent=m; missedList.appendChild(li);});
  units[currentUnitIndex].lastScore=pct;
  if(units[currentUnitIndex].highScore===null || pct>units[currentUnitIndex].highScore) units[currentUnitIndex].highScore=pct;
  if(pct>=80) units[currentUnitIndex].mastered=true;
  lastScoreText.textContent=`Last Unit Test Score: ${units[currentUnitIndex].lastScore}`;
  highScoreText.textContent=`Highest Unit Test Score: ${units[currentUnitIndex].highScore}`;
  reviewDiv.style.display='none';
  scoreScreen.style.display='block';
}
</script>
</body>
</html>
